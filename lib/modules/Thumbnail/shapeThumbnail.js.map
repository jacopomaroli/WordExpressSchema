{"version":3,"sources":["../../../src/modules/Thumbnail/shapeThumbnail.js"],"names":["thumbnail","settings","file","fileMeta","publicSettings","amazonS3","uploads","wp_prefix","privateSettings","forEach","postmeta","meta_key","meta_value","thumbnailSrc","PHPUnserialize","unserialize","key","thumbMeta","sizes","size","id","src"],"mappings":";;;;;;kBAGe,UAAUA,SAAV,EAAqBC,QAArB,EAA+B;AAC5C,MAAIC,aAAJ;AAAA,MAAUC,iBAAV;AAD4C,8BAEhBF,SAASG,cAFO;AAAA,MAErCC,QAFqC,yBAErCA,QAFqC;AAAA,MAE3BC,OAF2B,yBAE3BA,OAF2B;AAAA,MAGrCC,SAHqC,GAGxBN,SAASO,eAHe,CAGrCD,SAHqC;;;AAK5CP,YAAaO,SAAb,eAAkCE,OAAlC,CAA0C,oBAAY;AACpD,YAAOC,SAASC,QAAhB;AACA,WAAK,mBAAL;AACET,eAAOQ,SAASE,UAAhB;AACA;AACF,WAAK,yBAAL;AACET,mBAAWO,SAASE,UAApB;AACA;AANF;AAQD,GATD;;AAWA,MAAIV,IAAJ,EAAU;AACR,QAAMW,eAAeR,WACnBC,UAAUQ,yBAAeC,WAAf,CAA2Bb,IAA3B,EAAiCc,GADxB,GAEnBV,UAAUJ,IAFZ;;AAIA,QAAMe,YAAYH,yBAAeC,WAAf,CAA2BZ,QAA3B,CAAlB;AACA,QAAMe,QAAQ,iBAAID,UAAUC,KAAd,EAAqB,UAACC,IAAD,EAAOH,GAAP,EAAe;AAChD,aAAO;AACLG,cAAMH,GADD;AAELd,cAAMiB,KAAKjB;AAFN,OAAP;AAID,KALa,CAAd;;AAOA,WAAO;AACLkB,UAAIpB,UAAUoB,EADT;AAELC,WAAKR,YAFA;AAGLK,aAAOA;AAHF,KAAP;AAKD;;AAED,SAAO,IAAP;AACD,C;;AAxCD;;;;AACA","file":"shapeThumbnail.js","sourcesContent":["import PHPUnserialize from 'php-unserialize'\r\nimport {map} from 'lodash'\r\n\r\nexport default function (thumbnail, settings) {\r\n  let file, fileMeta\r\n  const {amazonS3, uploads} = settings.publicSettings\r\n  const {wp_prefix} = settings.privateSettings\r\n  \r\n  thumbnail[`${wp_prefix}postmeta`].forEach(postmeta => {\r\n    switch(postmeta.meta_key) {\r\n    case '_wp_attached_file':\r\n      file = postmeta.meta_value\r\n      break\r\n    case '_wp_attachment_metadata':\r\n      fileMeta = postmeta.meta_value\r\n      break\r\n    }\r\n  })\r\n  \r\n  if (file) {\r\n    const thumbnailSrc = amazonS3 ?\r\n      uploads + PHPUnserialize.unserialize(file).key :\r\n      uploads + file\r\n\r\n    const thumbMeta = PHPUnserialize.unserialize(fileMeta)\r\n    const sizes = map(thumbMeta.sizes, (size, key) => {\r\n      return {\r\n        size: key,\r\n        file: size.file\r\n      }\r\n    })\r\n\r\n    return {\r\n      id: thumbnail.id,\r\n      src: thumbnailSrc,\r\n      sizes: sizes\r\n    }\r\n  }\r\n\r\n  return null\r\n}"]}