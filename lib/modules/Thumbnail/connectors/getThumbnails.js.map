{"version":3,"sources":["../../../../src/modules/Thumbnail/connectors/getThumbnails.js"],"names":["Postmeta","Post","settings","ids","where","post_type","id","Op","in","amazonS3","publicSettings","metaKeys","push","findAll","include","model","then","thumbnails","map","thumbnail","Sequelize"],"mappings":";;;;;;kBAKe,UAAUA,QAAV,EAAoBC,IAApB,EAA0BC,QAA1B,EAAoC;AACjD,SAAO,UAASC,GAAT,EAAc;AACnB,QAAMC,QAAQ;AACZC,iBAAW,YADC;AAEZC,8BACGC,GAAGC,EADN,EACWL,GADX;AAFY,KAAd;;AADmB,QAQZM,QARY,GAQAP,SAASQ,cART,CAQZD,QARY;;AASnB,QAAME,WAAWF,WAAW,CAAC,eAAD,CAAX,GAA+B,CAAC,mBAAD,CAAhD;AACAE,aAASC,IAAT,CAAc,yBAAd;;AAEA,WAAOX,KAAKY,OAAL,CAAa;AAClBT,aAAOA,KADW;AAElBU,eAAS;AACPC,eAAOf;AADA;AAFS,KAAb,EAKJgB,IALI,CAKC,sBAAc;AACpB,UAAIC,UAAJ,EAAgB;AACd,eAAOA,WAAWC,GAAX,CAAe,qBAAa;AACjC,iBAAO,8BAAeC,SAAf,EAA0BjB,QAA1B,CAAP;AACD,SAFM,CAAP;AAGD;AACD,aAAO,IAAP;AACD,KAZM,CAAP;AAaD,GAzBD;AA0BD,C;;AAhCD;;;;AACA;;;;;;;;AAEA,IAAMK,KAAKa,oBAAUb,EAArB","file":"getThumbnails.js","sourcesContent":["import Sequelize from 'sequelize'\r\nimport shapeThumbnail from '../shapeThumbnail'\r\n\r\nconst Op = Sequelize.Op\r\n\r\nexport default function (Postmeta, Post, settings) {\r\n  return function(ids) {\r\n    const where = {\r\n      post_type: 'attachment',\r\n      id: {\r\n        [Op.in]: ids\r\n      }\r\n    }\r\n\r\n    const {amazonS3} = settings.publicSettings\r\n    const metaKeys = amazonS3 ? ['amazonS3_info'] : ['_wp_attached_file']\r\n    metaKeys.push('_wp_attachment_metadata')\r\n\r\n    return Post.findAll({\r\n      where: where,\r\n      include: {\r\n        model: Postmeta\r\n      }\r\n    }).then(thumbnails => {\r\n      if (thumbnails) {\r\n        return thumbnails.map(thumbnail => {\r\n          return shapeThumbnail(thumbnail, settings)\r\n        })\r\n      }\r\n      return null\r\n    })\r\n  }\r\n}"]}